# Руководство по обновлению чита ShakeDown Client

## Для администраторов

### Как загрузить новую версию чита

1. **Подготовьте файл чита**
   - Соберите новую версию чита (`.jar` файл)
   - Загрузите файл на облачное хранилище (Dropbox, Google Drive, GitHub Releases)
   - Получите **прямую ссылку** для скачивания

2. **Войдите в админ-панель**
   - Перейдите на сайт: https://oneshakedown.onrender.com
   - Войдите как администратор
   - Откройте раздел "Админ-панель"

3. **Загрузите новую версию**
   - Перейдите на вкладку "Версии чита"
   - Заполните форму:
     - **Версия**: например, `1.0.1`
     - **Ссылка для скачивания**: прямая ссылка на `.jar` файл
     - **Список изменений**: опишите, что нового в этой версии
   - Нажмите "Загрузить версию"

4. **Готово!**
   - Новая версия автоматически станет активной
   - Все пользователи лаунчера получат уведомление об обновлении
   - При следующем запуске лаунчер автоматически скачает новую версию

### Получение прямой ссылки

#### Dropbox
1. Загрузите файл на Dropbox
2. Нажмите "Поделиться" → "Создать ссылку"
3. Скопируйте ссылку и замените `?dl=0` на `?dl=1` в конце
4. Пример: `https://www.dropbox.com/s/xxxxx/arizon-client-1.0.1.jar?dl=1`

#### Google Drive
1. Загрузите файл на Google Drive
2. Нажмите ПКМ → "Получить ссылку" → "Доступ для всех, у кого есть ссылка"
3. Скопируйте ID файла из ссылки
4. Используйте формат: `https://drive.google.com/uc?export=download&id=FILE_ID`

#### GitHub Releases
1. Создайте новый Release в репозитории
2. Прикрепите `.jar` файл к релизу
3. Скопируйте прямую ссылку на файл из Assets
4. Пример: `https://github.com/user/repo/releases/download/v1.0.1/arizon-client-1.0.1.jar`

## Для пользователей

### Как работает автообновление

1. **Автоматическая проверка**
   - При запуске лаунчера автоматически проверяется наличие обновлений
   - Если доступна новая версия, вы увидите уведомление

2. **Автоматическая загрузка**
   - При нажатии "Запустить" лаунчер автоматически:
     - Удалит старую версию чита
     - Скачает новую версию
     - Установит её в папку модов
     - Запустит игру с новой версией

3. **Без ручной установки**
   - Больше не нужно вручную копировать файлы
   - Больше не нужно запускать `quick-setup.bat`
   - Всё происходит автоматически!

### Проверка версии

В главном окне лаунчера отображается:
- Текущая установленная версия чита
- Уведомление о доступном обновлении (если есть)

## Технические детали

### API Endpoints

#### Получение текущей версии
```
GET /api/client/version
```

Ответ:
```json
{
  "success": true,
  "data": {
    "version": "1.0.1",
    "downloadUrl": "https://example.com/arizon-client-1.0.1.jar",
    "changelog": "Исправлены баги, добавлены новые функции",
    "uploadedAt": "2024-01-15T10:30:00.000Z"
  }
}
```

#### Загрузка новой версии (только для админов)
```
POST /api/client/version
Content-Type: application/json

{
  "version": "1.0.1",
  "downloadUrl": "https://example.com/arizon-client-1.0.1.jar",
  "changelog": "Список изменений",
  "userId": 1
}
```

#### История версий
```
GET /api/client/versions
```

### База данных

Таблица `client_versions`:
- `id` - уникальный идентификатор
- `version` - номер версии
- `download_url` - ссылка для скачивания
- `changelog` - список изменений
- `uploaded_by` - ID администратора, загрузившего версию
- `uploaded_at` - дата и время загрузки
- `is_active` - активна ли версия (только одна может быть активной)

### Логика обновления в лаунчере

1. При установке/запуске клиента вызывается `checkForClientUpdate()`
2. Если найдена новая версия на сервере:
   - Удаляются все старые файлы `arizon-client-*.jar` из папки модов
   - Скачивается новая версия с указанного URL
   - Файл сохраняется как `arizon-client-{version}.jar`
3. Если сервер недоступен или версия не найдена:
   - Используется fallback: установка из локальных файлов проекта

## Устранение неполадок

### Обновление не скачивается
- Проверьте, что ссылка для скачивания работает (откройте в браузере)
- Убедитесь, что это прямая ссылка на файл, а не страница просмотра
- Проверьте размер файла (должен быть больше 10 КБ)

### Старая версия не удаляется
- Закройте Minecraft, если он запущен
- Вручную удалите старые файлы из `C:\ShakeDown\minecraft\mods\`
- Перезапустите лаунчер

### Ошибка "Файл слишком маленький"
- Ссылка ведет не на файл, а на страницу
- Используйте прямую ссылку для скачивания (см. инструкции выше)

## Поддержка

При возникновении проблем обращайтесь к администраторам проекта.
